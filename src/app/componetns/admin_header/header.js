import React, { useState } from 'react';
import './style.scss';
import { Menu, MenuItem } from '@mui/material';
import { useNavigate } from 'react-router-dom';
import routerConstants from '../../../constants/routerConstants';
import toaster from '../../../utility/toaster/toaster';
import { postRequest } from '../../../services/axios-api-request/axios_api_Request';
import { apiurl } from '../../../constants/apiURLsConstants';
import Swal from 'sweetalert2';

function Header() {
  const [openMenu, setOpenMenu] = useState(false);
  const navigate = useNavigate();

  const handleOpenMenu = (event) => setOpenMenu(event.currentTarget);
  const handleCloseMenu = () => setOpenMenu(false);
  const handleClickMenu = () => {
    handleCloseMenu();
    navigate(routerConstants?.changePasswordRoute)
  };


  const handleLogoutMenu = () => {
    handleCloseMenu();
    Swal.fire({
      customClass: 'logout-confirmation-box',
      title: 'Are you sure?',
      text: "Are you sure you want to logout?",
      icon: "warning",
      showCancelButton: true,
      confirmButtonColor: "#0d6efd",
      confirmButtonText: "Yes, Logout",
      cancelButtonText: 'No',
      iconHtml: `<svg width="60" height="61" viewBox="0 0 60 61" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_2589_8456)">
                <path d="M28.2246 0.730375C4.93463 2.27038 -7.82537 28.5904 5.65463 47.8104C17.5446 64.7804 43.2546 64.4504 54.7746 47.2204C68.4646 26.7404 52.7346 -0.879625 28.2246 0.730375ZM29.1646 51.9504C24.3846 51.3204 24.3046 43.8604 29.2046 43.0604C35.9746 41.9604 36.3946 52.9004 29.1646 51.9504ZM33.7146 38.2404C33.4746 38.6404 26.4146 38.7704 26.2746 38.1004L24.5546 13.7604C25.8546 7.60038 34.1646 7.58038 35.4746 13.7604L33.7146 38.2404Z" fill="#0d6efd"/>
                </g>
                <defs>
                <clipPath id="clip0_2589_8456">
                <rect width="59.69" height="59.68" fill="white" transform="translate(0.154785 0.660156)"/>
                </clipPath>
                </defs>
                </svg>`,
      preConfirm: async () => {
        // Swal.showLoading(); // Show loader
        // const token = localStorage.getItem('ACCESS_TOKEN');
        // try {
        //   const res = await postRequest(apiurl?.LOGOUT_URL, { token });

        //   if (res?.data?.success) {
        //     localStorage.clear();
        //     toaster('success', res?.data?.message);
        //     navigate(routerConstants?.landingPage);
        //   } else {
        //     toaster('error', res?.data?.message);
        //     return false;
        //   }
        // } catch (error) {
        //   toaster('error', 'An error occurred while logging out.');
        //   return false;
        // }


        localStorage.clear();
        toaster('success', "Logged out successfully!")
        navigate('/login')
      },
      allowOutsideClick: () => !Swal.isLoading(),
    })
  };

  return (
    <>
      <div className="header_info">
        <div className='notification'>
          <svg width="39" height="39" viewBox="0 0 39 39" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect width="39" height="39" rx="19.5" fill="#EDF2FF" />
            <path fillRule="evenodd" clipRule="evenodd" d="M22.0353 27.358C22.6774 27.2936 23.1113 27.9752 22.808 28.5269C22.5942 28.9157 22.293 29.2551 21.9321 29.533C21.5641 29.8164 21.1371 30.0339 20.6791 30.1799C20.2209 30.3262 19.7343 30.4002 19.246 30.4002C18.7576 30.4002 18.2711 30.3262 17.8128 30.1799C17.3548 30.0339 16.9279 29.8164 16.5599 29.533C16.199 29.2551 15.8977 28.9157 15.684 28.5269C15.3807 27.9752 15.8145 27.2936 16.4566 27.358C16.6569 27.3781 18.2242 27.5313 19.246 27.5313C20.2677 27.5313 21.835 27.3781 22.0353 27.358Z" fill="#4285F4" />
            <path fillRule="evenodd" clipRule="evenodd" d="M15.501 8.87448C17.8595 7.74625 20.6234 7.70787 23.0148 8.77013L23.2286 8.86507C25.7345 9.97815 27.3389 12.3897 27.3389 15.0433V16.3593C27.3389 17.4171 27.5787 18.4622 28.0417 19.4218L28.3182 19.9949C29.588 22.627 27.9343 25.7036 24.9662 26.231L24.7989 26.2607C21.127 26.9131 17.3618 26.9131 13.69 26.2607C10.682 25.7263 9.0906 22.5273 10.5462 19.9411L10.7827 19.521C11.3665 18.4837 11.6722 17.323 11.6722 16.1437V14.817C11.6722 12.2983 13.1552 9.9966 15.501 8.87448Z" fill="#AECDFF" />
          </svg>
        </div>
        <div className='settings'>
          <svg width="39" height="39" viewBox="0 0 39 39" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect width="39" height="39" rx="19.5" fill="#EDF2FF" />
            <path d="M9.08325 20.4166V18.5832C9.08325 17.4999 9.96867 16.6041 11.0624 16.6041C12.9478 16.6041 13.7187 15.2708 12.7708 13.6354C12.2291 12.6979 12.552 11.4791 13.4999 10.9374L15.302 9.90619C16.1249 9.41661 17.1874 9.70828 17.677 10.5312L17.7916 10.7291C18.7291 12.3645 20.2708 12.3645 21.2187 10.7291L21.3333 10.5312C21.8228 9.70828 22.8853 9.41661 23.7083 9.90619L25.5103 10.9374C26.4583 11.4791 26.7812 12.6979 26.2395 13.6354C25.2916 15.2708 26.0624 16.6041 27.9478 16.6041C29.0312 16.6041 29.927 17.4895 29.927 18.5832V20.4166C29.927 21.4999 29.0416 22.3957 27.9478 22.3957C26.0624 22.3957 25.2916 23.7291 26.2395 25.3645C26.7812 26.3124 26.4583 27.5207 25.5103 28.0624L23.7083 29.0937C22.8853 29.5832 21.8228 29.2916 21.3333 28.4687L21.2187 28.2707C20.2812 26.6353 18.7395 26.6353 17.7916 28.2707L17.677 28.4687C17.1874 29.2916 16.1249 29.5832 15.302 29.0937L13.4999 28.0624C12.552 27.5207 12.2291 26.302 12.7708 25.3645C13.7187 23.7291 12.9478 22.3957 11.0624 22.3957C9.96867 22.3957 9.08325 21.4999 9.08325 20.4166Z" fill="#AECDFF" />
            <path d="M19.4999 22.8854C21.3696 22.8854 22.8853 21.3697 22.8853 19.5C22.8853 17.6303 21.3696 16.1146 19.4999 16.1146C17.6302 16.1146 16.1145 17.6303 16.1145 19.5C16.1145 21.3697 17.6302 22.8854 19.4999 22.8854Z" fill="#4285F4" />
          </svg>
        </div>
        <div className='logo' onClick={handleOpenMenu}>
          <img src='/images/user-img.png' alt='user' />
        </div>
      </div>

      {openMenu && (
        <Menu
          anchorEl={openMenu}
          anchorReference={null}
          anchorOrigin={{
            vertical: "bottom",
            horizontal: "left",
          }}
          open={Boolean(openMenu)}
          onClose={handleCloseMenu}
          className="topbar-custom-menu"
        >
          <MenuItem onClick={() => {
            handleCloseMenu();
          }} disableRipple>
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M10.0027 1.04102C7.81659 1.04102 6.04438 2.81322 6.04438 4.99935C6.04438 7.18548 7.81659 8.95768 10.0027 8.95768C12.1888 8.95768 13.961 7.18548 13.961 4.99935C13.961 2.81322 12.1888 1.04102 10.0027 1.04102ZM7.29438 4.99935C7.29438 3.50358 8.50695 2.29102 10.0027 2.29102C11.4985 2.29102 12.711 3.50358 12.711 4.99935C12.711 6.49512 11.4985 7.70768 10.0027 7.70768C8.50695 7.70768 7.29438 6.49512 7.29438 4.99935Z" fill="#1C274C" />
              <path fill-rule="evenodd" clip-rule="evenodd" d="M10.0027 10.2077C8.07476 10.2077 6.29849 10.6459 4.98226 11.3863C3.68562 12.1157 2.71105 13.2211 2.71105 14.5827L2.71099 14.6676C2.71005 15.6359 2.70887 16.851 3.77473 17.719C4.29928 18.1461 5.03311 18.4499 6.02456 18.6506C7.01877 18.8518 8.31457 18.9577 10.0027 18.9577C11.6909 18.9577 12.9867 18.8518 13.9809 18.6506C14.9723 18.4499 15.7061 18.1461 16.2307 17.719C17.2966 16.851 17.2954 15.6359 17.2944 14.6676L17.2944 14.5827C17.2944 13.2211 16.3198 12.1157 15.0232 11.3863C13.7069 10.6459 11.9307 10.2077 10.0027 10.2077ZM3.96105 14.5827C3.96105 13.8732 4.47886 13.1036 5.59508 12.4758C6.69171 11.8589 8.24878 11.4577 10.0027 11.4577C11.7567 11.4577 13.3137 11.8589 14.4103 12.4758C15.5266 13.1036 16.0444 13.8732 16.0444 14.5827C16.0444 15.6725 16.0108 16.286 15.4414 16.7497C15.1326 17.0011 14.6164 17.2466 13.7329 17.4254C12.8521 17.6037 11.6479 17.7077 10.0027 17.7077C8.35753 17.7077 7.15333 17.6037 6.27254 17.4254C5.38899 17.2466 4.87282 17.0011 4.56404 16.7497C3.99465 16.286 3.96105 15.6725 3.96105 14.5827Z" fill="#1C274C" />
            </svg>
            <span>View Profile</span>
          </MenuItem>
          <MenuItem onClick={handleClickMenu} disableRipple>
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6.66797 14.166C7.12821 14.166 7.5013 13.7929 7.5013 13.3327C7.5013 12.8724 7.12821 12.4993 6.66797 12.4993C6.20773 12.4993 5.83464 12.8724 5.83464 13.3327C5.83464 13.7929 6.20773 14.166 6.66797 14.166Z" fill="black" />
              <path d="M10.0013 14.166C10.4615 14.166 10.8346 13.7929 10.8346 13.3327C10.8346 12.8724 10.4615 12.4993 10.0013 12.4993C9.54107 12.4993 9.16797 12.8724 9.16797 13.3327C9.16797 13.7929 9.54107 14.166 10.0013 14.166Z" fill="black" />
              <path d="M14.168 13.3327C14.168 13.7929 13.7949 14.166 13.3346 14.166C12.8744 14.166 12.5013 13.7929 12.5013 13.3327C12.5013 12.8724 12.8744 12.4993 13.3346 12.4993C13.7949 12.4993 14.168 12.8724 14.168 13.3327Z" fill="black" />
              <path fill-rule="evenodd" clip-rule="evenodd" d="M5.6263 6.66602C5.6263 4.24977 7.58506 2.29102 10.0013 2.29102C12.039 2.29102 13.7528 3.6847 14.2385 5.5718C14.3245 5.90609 14.6653 6.10733 14.9996 6.02129C15.3339 5.93525 15.5351 5.59451 15.4491 5.26023C14.8247 2.83426 12.6232 1.04102 10.0013 1.04102C6.8947 1.04102 4.3763 3.55941 4.3763 6.66602V7.75166C4.18728 7.76495 4.00912 7.78225 3.84151 7.80478C3.09142 7.90563 2.45986 8.12138 1.95826 8.62297C1.45666 9.12457 1.24092 9.75613 1.14007 10.5062C1.04294 11.2287 1.04295 12.1473 1.04297 13.2869V13.3784C1.04295 14.5181 1.04294 15.4367 1.14007 16.1591C1.24092 16.9092 1.45666 17.5408 1.95826 18.0424C2.45986 18.544 3.09142 18.7597 3.84151 18.8606C4.56398 18.9577 5.48259 18.9577 6.62225 18.9577H13.3804C14.52 18.9577 15.4386 18.9577 16.1611 18.8606C16.9112 18.7597 17.5427 18.544 18.0443 18.0424C18.5459 17.5408 18.7617 16.9092 18.8625 16.1591C18.9597 15.4367 18.9597 14.5181 18.9596 13.3784V13.287C18.9597 12.1473 18.9597 11.2287 18.8625 10.5062C18.7617 9.75613 18.5459 9.12457 18.0443 8.62297C17.5427 8.12138 16.9112 7.90563 16.1611 7.80478C15.4386 7.70765 14.52 7.70766 13.3804 7.70768H6.62224C6.26931 7.70768 5.93758 7.70767 5.6263 7.71055V6.66602ZM4.00807 9.04364C3.39659 9.12585 3.07278 9.27622 2.84214 9.50686C2.61151 9.73749 2.46114 10.0613 2.37893 10.6728C2.2943 11.3022 2.29297 12.1365 2.29297 13.3327C2.29297 14.5289 2.2943 15.3631 2.37893 15.9926C2.46114 16.6041 2.61151 16.9279 2.84214 17.1585C3.07278 17.3891 3.39659 17.5395 4.00807 17.6217C4.63753 17.7064 5.47179 17.7077 6.66797 17.7077H13.3346C14.5308 17.7077 15.3651 17.7064 15.9945 17.6217C16.606 17.5395 16.9298 17.3891 17.1605 17.1585C17.3911 16.9279 17.5415 16.6041 17.6237 15.9926C17.7083 15.3631 17.7096 14.5289 17.7096 13.3327C17.7096 12.1365 17.7083 11.3022 17.6237 10.6728C17.5415 10.0613 17.3911 9.73749 17.1605 9.50686C16.9298 9.27622 16.606 9.12585 15.9945 9.04364C15.3651 8.95901 14.5308 8.95768 13.3346 8.95768H6.66797C5.47179 8.95768 4.63753 8.95901 4.00807 9.04364Z" fill="black" />
            </svg>
            <span>Change Password</span>
          </MenuItem>
          <MenuItem onClick={handleLogoutMenu} disableRipple>
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M4.55806 10.4413C4.31398 10.1972 4.31398 9.80149 4.55806 9.55741L6.22473 7.89074C6.4688 7.64667 6.86453 7.64667 7.10861 7.89074C7.35269 8.13482 7.35269 8.53055 7.10861 8.77463L6.50889 9.37435L12.5 9.37435C12.8452 9.37435 13.125 9.65417 13.125 9.99935C13.125 10.3445 12.8452 10.6244 12.5 10.6244L6.50889 10.6244L7.10861 11.2241C7.35269 11.4682 7.35269 11.8639 7.10861 12.108C6.86453 12.352 6.4688 12.352 6.22473 12.108L4.55806 10.4413Z" fill="black" />
              <path fill-rule="evenodd" clip-rule="evenodd" d="M11.6211 1.04102H12.5459C13.6856 1.041 14.6042 1.04099 15.3266 1.13812C16.0767 1.23897 16.7083 1.45471 17.2099 1.95631C17.7115 2.45791 17.9272 3.08947 18.0281 3.83956C18.1252 4.56203 18.1252 5.48063 18.1252 6.62029V13.3784C18.1252 14.5181 18.1252 15.4367 18.0281 16.1591C17.9272 16.9092 17.7115 17.5408 17.2099 18.0424C16.7083 18.544 16.0767 18.7597 15.3266 18.8606C14.6042 18.9577 13.6856 18.9577 12.5459 18.9577H11.6211C10.4815 18.9577 9.56286 18.9577 8.84039 18.8606C8.0903 18.7597 7.45874 18.544 6.95714 18.0424C6.62469 17.7099 6.41724 17.3197 6.28587 16.8742C5.49307 16.8732 4.83255 16.8645 4.29741 16.7925C3.66078 16.7069 3.10883 16.5217 2.66825 16.0811C2.22768 15.6405 2.04244 15.0886 1.95685 14.4519C1.87497 13.8429 1.87498 13.0715 1.875 12.1275V7.87127C1.87498 6.92726 1.87497 6.1558 1.95685 5.54675C2.04244 4.91013 2.22768 4.35818 2.66825 3.9176C3.10883 3.47703 3.66078 3.29179 4.29741 3.2062C4.83255 3.13425 5.49307 3.12553 6.28587 3.12449C6.41724 2.67903 6.62469 2.28876 6.95714 1.95631C7.45874 1.45471 8.0903 1.23897 8.84039 1.13812C9.56286 1.04099 10.4815 1.041 11.6211 1.04102ZM6.04331 14.1695C6.0463 14.7066 6.05516 15.1904 6.0857 15.6236C5.3903 15.6209 4.87333 15.6087 4.46397 15.5537C3.96595 15.4867 3.72175 15.3668 3.55214 15.1972C3.38252 15.0276 3.26266 14.7834 3.1957 14.2854C3.12633 13.7694 3.125 13.0824 3.125 12.0827V7.91602C3.125 6.91626 3.12633 6.22931 3.1957 5.71331C3.26266 5.2153 3.38252 4.9711 3.55214 4.80149C3.72175 4.63187 3.96595 4.51201 4.46397 4.44505C4.87333 4.39001 5.3903 4.3778 6.08571 4.37511C6.05516 4.80829 6.0463 5.29209 6.04331 5.82921C6.04138 6.17438 6.31964 6.45575 6.66482 6.45767C7.00999 6.4596 7.29137 6.18134 7.29329 5.83616C7.29836 4.92492 7.32202 4.27901 7.41207 3.78881C7.49883 3.31646 7.63814 3.04307 7.84102 2.84019C8.07166 2.60956 8.39547 2.45918 9.00695 2.37697C9.63641 2.29234 10.4707 2.29102 11.6668 2.29102H12.5002C13.6964 2.29102 14.5306 2.29234 15.1601 2.37697C15.7716 2.45918 16.0954 2.60956 16.326 2.84019C16.5566 3.07083 16.707 3.39464 16.7892 4.00612C16.8739 4.63558 16.8752 5.46984 16.8752 6.66602V13.3327C16.8752 14.5289 16.8739 15.3631 16.7892 15.9926C16.707 16.6041 16.5566 16.9279 16.326 17.1585C16.0954 17.3891 15.7716 17.5395 15.1601 17.6217C14.5306 17.7064 13.6964 17.7077 12.5002 17.7077H11.6668C10.4707 17.7077 9.63641 17.7064 9.00695 17.6217C8.39547 17.5395 8.07166 17.3891 7.84102 17.1585C7.63814 16.9556 7.49883 16.6822 7.41207 16.2099C7.32202 15.7197 7.29836 15.0738 7.29329 14.1625C7.29137 13.8174 7.00999 13.5391 6.66482 13.541C6.31964 13.5429 6.04138 13.8243 6.04331 14.1695Z" fill="black" />
            </svg>
            <span>Logout</span>
          </MenuItem>
        </Menu>
      )}
    </>
  );
}

export default Header;
